---
title: "データサイエンス演習_第5週"
author: "浅賀慎之助"
date: "2025-10-20"
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

## 課題１

あるメーカー制のコインを正確に造られているかどうかを知るため、コイントス実験を行い、以下のデータが得られた.

実験A: コインを100回投げて、表が45回出た. 実験B:
コインを10000回投げて、表が4700回出た. コインメーカの主張：
コインが正確に造られている.
実験A、実験Bがこの仮説を支持しているか、有意水準5％の検定結果を持って答えよ

```{r}
# 実験A
n_a <- 100   # 試行回数
x_a <- 45    # 表が出た回数
p0 <- 0.5    # 帰無仮説での表が出る確率

# 統計量の計算（正規近似）
# z = (x - n*p0) / sqrt(n*p0*(1-p0))
z_a <- (x_a - n_a * p0) / sqrt(n_a * p0 * (1 - p0))

# p値（両側検定）
p_value_a <- 2 * (1 - pnorm(abs(z_a)))

cat("実験A:\n")
cat(sprintf("  統計量 z: %.4f\n", z_a))
cat(sprintf("  p値: %.4f\n", p_value_a))

# 検定結果
alpha <- 0.05
if (p_value_a < alpha) {
  cat(sprintf("  有意水準 %.2f で帰無仮説を棄却する。コインは正確に作られていない可能性が高い。\n", alpha))
} else {
  cat(sprintf("  有意水準 %.2f で帰無仮説を棄却できない。コインは正確に作られているという仮説を支持する。\n", alpha))
}


# 実験B
n_b <- 10000  # 試行回数
x_b <- 4700   # 表が出た回数

# 統計量の計算（正規近似）
z_b <- (x_b - n_b * p0) / sqrt(n_b * p0 * (1 - p0))

# p値の計算（両側検定）
p_value_b <- 2 * (1 - pnorm(abs(z_b)))

cat("\n実験B:\n")
cat(sprintf("  統計量 z: %.4f\n", z_b))
cat(sprintf("  p値: %.4f\n", p_value_b))

# 検定結果
if (p_value_b < alpha) {
  cat(sprintf("  有意水準 %.2f で帰無仮説を棄却します。コインは正確に作られていない可能性が高い。\n", alpha))
} else {
  cat(sprintf("  有意水準 %.2f で帰無仮説を棄却できません。コインは正確に作られているという仮説を支持する。\n", alpha))
}
```

## 課題2

ある工場での経験によると
7mmボルトの規格の製品の寸法はほぼ正規分布をしており，その標準偏差は0.20mmであるという．
ある日の製品から100個のボルトをランダムに抽出したところ，その寸法の平均が7.09mmであった．
この日の製品寸法の平均は規格から外れているか、有意水準５％で検定せよ.

```{r}
# 帰無仮説 H0: 母平均 μ = 7.0 mm
mu_0 <- 7.0       # 帰無仮説での母平均
sigma <- 0.20     # 母標準偏差（既知）
n <- 100          # 標本サイズ
x_bar <- 7.09     # 標本平均
alpha <- 0.05     # 有意水準

# 検定統計量 Z =  (標本平均 - 母平均) / (母標準偏差 / sqrt(標本サイズ))
z_stat <- (x_bar - mu_0) / (sigma / sqrt(n))

# p値（両側検定）
p_value <- 2 * (1 - pnorm(abs(z_stat)))


# 検定結果
if (p_value < alpha) {
  cat(sprintf("有意水準 %.2f で帰無仮説を棄却する。規格から有意に外れている可能性が高い。\n", alpha))
} else {
  cat(sprintf("有意水準 %.2f で帰無仮説を棄却しない。規格から有意に外れているとは言えない。\n", alpha))
}
```

## 課題3

H社で製造中のリベットの直径の分散は0.42とバラツキが大き
いので、新しい製造方法を導入した.
この新しい製造方法で作られたリベットの中から10個のサン
プルを無作為抽出し、直径を測定したところ, 次の結果になりました.

```         
 ｛35.2, 34.5,34.9,35.2,34.8; 35.1, 34.9,35.2,34.9,34.8｝
```

新しい製造方法で、リベットの直径のバラツキは改善されたか、有意水準5％で検定せよ.

```{r}
# 標本データ
data <- c(35.2, 34.5, 34.9, 35.2, 34.8, 35.1, 34.9, 35.2, 34.9, 34.8)

sigma2_0 <- 0.4^2   # 帰無仮説での母分散（古い製造方法での分散）
n <- length(data)   # 標本サイズ
alpha <- 0.05       # 有意水準

# 標本分散（不偏分散）
sample_variance <- var(data)

# 検定統計量 χ^2 = (n - 1) * s^2 / σ0^2
chi2_stat <- (n - 1) * sample_variance / sigma2_0

# p値（左側検定）
p_value <- pchisq(chi2_stat, df = n - 1)

# 臨界値
critical_value <- qchisq(alpha, df = n - 1)
.
# 出力
cat(sprintf("χ² 統計量: %.4f\n", chi2_stat))
cat(sprintf("p値: %.4f\n", p_value))
cat(sprintf("有意水準 %.2f で棄却する際の臨界値: %.4f\n", alpha, critical_value))

# 検定結果
if (p_value < alpha) {
  cat(sprintf("有意水準 %.2f で帰無仮説を棄却する。新しい製造方法により、リベットの直径のバラツキは有意に改善された可能性が高い。\n", alpha))
} else {
  cat(sprintf("有意水準 %.2f で帰無仮説を棄却しない。新しい製造方法によっても、リベットの直径のバラツキが有意に改善されたとは言えない。\n", alpha))
}

```
